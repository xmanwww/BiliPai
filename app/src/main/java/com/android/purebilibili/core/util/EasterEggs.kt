//  BiliPai å½©è›‹ç³»ç»Ÿ
// å¢æ·»åº”ç”¨è¶£å‘³æ€§çš„å°æƒŠå–œ
package com.android.purebilibili.core.util

import java.util.Calendar
import kotlin.random.Random

/**
 *  å½©è›‹ç®¡ç†å™¨
 * æä¾›å„ç§æœ‰è¶£çš„äº’åŠ¨å½©è›‹
 */
object EasterEggs {
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ‰ ä¸‹æ‹‰åˆ·æ–°è¶£å‘³æç¤ºè¯­
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val refreshMessages = listOf(
        "åˆ·åˆ°å¥½å†…å®¹äº†ï½ ğŸ‰",
        "æ–°é²œå‡ºç‚‰ï¼çƒ­ä¹çš„ï½ ",
        "åŠ è½½å®Œæˆï¼Œè¯·ç¬‘çº³ âœ¨",
        "å—–ï½æ–°å†…å®¹å·²å°±ä½ï¼",
        "ä½ çš„æ‰‹æ°”ä¸é”™å“¦ï½ ğŸ€",
        "å†…å®¹å·²æ›´æ–°ï¼Œå¿«å»çœ‹çœ‹å§ï¼",
        "åˆ·æ–°æˆåŠŸï¼Œå†²å†²å†²ï¼ğŸ’ª",
        "å®ï½æ–°è§†é¢‘åˆ°è´§å•¦ï¼",
        "å·²åˆ·æ–°ï¼Œä»Šå¤©ä¹Ÿè¦å¼€å¿ƒï¼ğŸ˜Š",
        "å†…å®¹åŠ è½½å®Œæ¯•ï¼Œè¯·äº«ç”¨ï½"
    )
    
    //  æ·±å¤œå½©è›‹ (23:00 - 05:00)
    private val lateNightMessages = listOf(
        "å¤œæ·±äº†ï¼Œæ³¨æ„ä¼‘æ¯å“¦ï½ ",
        "ç†¬å¤œå† å†›å°±æ˜¯ä½ ï¼ğŸ†",
        "æœˆäº®éƒ½ç¡äº†ï¼Œä½ è¿˜åœ¨åˆ·ï¼Ÿ",
        "æ·±å¤œé£Ÿå ‚è¥ä¸šä¸­... ğŸœ",
        "ä½ å¾ˆåŠªåŠ›ï¼Œä½†ä¹Ÿè¦æ—©ç‚¹ç¡è§‰",
        "é»‘çœ¼åœˆåœ¨å‘ä½ æ‹›æ‰‹äº†ï½ ğŸ‘€"
    )
    
    // ğŸŒ… æ¸…æ™¨å½©è›‹ (05:00 - 08:00)
    private val earlyMorningMessages = listOf(
        "æ—©èµ·çš„é¸Ÿå„¿æœ‰è™«åƒï¼ğŸ¦",
        "æ¸…æ™¨å¥½ï¼ä»Šå¤©ä¹Ÿå…ƒæ°”æ»¡æ»¡ï¼â˜€ï¸",
        "èµ·å¾—çœŸæ—©ï¼ä½ è¶…æ£’çš„ï¼",
        "æ–°çš„ä¸€å¤©ï¼Œæ–°çš„å¼€å§‹ï½ ğŸŒ„"
    )
    
    // ğŸ‚ ç‰¹æ®Šæ—¥æœŸå½©è›‹
    private val specialDayMessages = mapOf(
        "01-01" to "æ–°å¹´å¿«ä¹ï¼ğŸŠ æ„¿æ–°çš„ä¸€å¹´ä¸‡äº‹å¦‚æ„ï¼",
        "02-14" to "æƒ…äººèŠ‚å¿«ä¹ï¼ğŸ’•",
        "05-01" to "åŠ³åŠ¨èŠ‚å¿«ä¹ï¼ğŸ’ª ä»Šå¤©ä¸åŠ³åŠ¨ï½",
        "05-04" to "é’å¹´èŠ‚å¿«ä¹ï¼å¹´è½»æ— æé™ï¼",
        "06-01" to "å„¿ç«¥èŠ‚å¿«ä¹ï¼ğŸˆ è°è¿˜ä¸æ˜¯ä¸ªå®å®å‘¢ï¼Ÿ",
        "10-01" to "å›½åº†èŠ‚å¿«ä¹ï¼ğŸ‡¨ğŸ‡³",
        "12-25" to "åœ£è¯å¿«ä¹ï¼ğŸ„ğŸ…",
        "12-31" to "æœ€åä¸€å¤©äº†ï¼Œè¾›è‹¦ä½ å•¦ï¼"
    )
    
    /**
     * è·å–åˆ·æ–°åçš„è¶£å‘³æç¤º
     * æ ¹æ®æ—¶é—´ã€æ—¥æœŸç­‰è¿”å›ä¸åŒçš„æç¤ºè¯­
     */
    fun getRefreshMessage(): String {
        val now = Calendar.getInstance()
        val hour = now.get(Calendar.HOUR_OF_DAY)
        val monthDay = String.format("%02d-%02d", 
            now.get(Calendar.MONTH) + 1, 
            now.get(Calendar.DAY_OF_MONTH)
        )
        
        // ä¼˜å…ˆæ£€æŸ¥ç‰¹æ®Šæ—¥æœŸ
        specialDayMessages[monthDay]?.let { return it }
        
        // æ ¹æ®æ—¶é—´æ®µè¿”å›ä¸åŒæç¤º
        return when (hour) {
            in 23..23, in 0..4 -> lateNightMessages.random()
            in 5..7 -> earlyMorningMessages.random()
            else -> refreshMessages.random()
        }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // âœ¨ ç‰ˆæœ¬å·ç‚¹å‡»å½©è›‹
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val versionClickMessages = listOf(
        "å†ç‚¹ %d æ¬¡æœ‰æƒŠå–œï¼",
        "ä½ åœ¨æ‰¾ä»€ä¹ˆï¼ŸğŸ¤”",
        "åˆ«ç‚¹å•¦ï½",
        "æˆ‘ç—’ç—’ï½åˆ«æˆ³äº†ï¼ğŸ˜†",
        "ä½ å‘ç°æˆ‘äº†ï¼",
        "ç‚¹ç‚¹ç‚¹ï¼Œä½ å¯çœŸä¼šç‚¹ï¼",
        "æ­å–œè§£é”éšè—æˆå°±ï¼ğŸ†"
    )
    
    /**
     * è·å–ç‰ˆæœ¬å·ç‚¹å‡»æç¤º
     * @param clickCount å½“å‰ç‚¹å‡»æ¬¡æ•°
     * @param threshold è§¦å‘å½©è›‹çš„é˜ˆå€¼
     */
    fun getVersionClickMessage(clickCount: Int, threshold: Int = 7): String {
        val remaining = threshold - clickCount
        return when {
            remaining > 3 -> "å†ç‚¹ $remaining æ¬¡æœ‰æƒŠå–œï¼"
            remaining == 3 -> "å°±å¿«äº†ï¼è¿˜å·® 3 æ¬¡..."
            remaining == 2 -> "è¿˜å·® 2 æ¬¡ï¼åŠ æ²¹ï¼"
            remaining == 1 -> "æœ€åä¸€æ¬¡ï¼"
            remaining == 0 -> "ğŸ‰ æ­å–œå‘ç°å¼€å‘è€…å½©è›‹ï¼"
            else -> versionClickMessages.random()
        }
    }
    
    /**
     * åˆ¤æ–­æ˜¯å¦è§¦å‘äº†ç‰ˆæœ¬å½©è›‹
     */
    fun isVersionEasterEggTriggered(clickCount: Int, threshold: Int = 7): Boolean {
        return clickCount >= threshold
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ’° æŠ•å¸è¶£å‘³æç¤º
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val coinMessages = listOf(
        "æ„Ÿè°¢åœŸè±ªï¼ğŸ’°",
        "ä½ çš„ç¡¬å¸é—ªé—ªå‘å…‰ï½ âœ¨",
        "UPä¸»ä¼šå¾ˆå¼€å¿ƒçš„ï¼",
        "å¤§æ‰‹ç¬”ï¼è±ªæ°”ï¼",
        "æŠ•å¸æˆåŠŸï¼ä½ å¾ˆæœ‰çœ¼å…‰ï½"
    )
    
    fun getCoinMessage(): String = coinMessages.random()
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // â¤ï¸ ç‚¹èµè¶£å‘³æç¤º  
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val likeMessages = listOf(
        "æ„Ÿè°¢ä½ çš„å–œæ¬¢ï¼â¤ï¸",
        "è¿™ä¸ªèµå¾ˆæœ‰åˆ†é‡ï¼",
        "èµï¼è¯´æ˜ä½ å¾ˆæœ‰å“å‘³ï½",
        "ä¸€ä¸ªèµï¼Œä¼ é€’æ»¡æ»¡æ­£èƒ½é‡ï¼",
        "è¢«ä½ å–œæ¬¢çš„è§†é¢‘å¾ˆå¹¸ç¦ï½"
    )
    
    fun getLikeMessage(): String = likeMessages.random()
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // â­ æ”¶è—è¶£å‘³æç¤º
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val favoriteMessages = listOf(
        "æ”¶è—å¤¹ +1 â­",
        "ç­‰ä½ æœ‰ç©ºæ…¢æ…¢çœ‹ï½",
        "å¥½è§†é¢‘å€¼å¾—æ”¶è—ï¼",
        "çè—æˆåŠŸï¼ğŸ",
        "è®°å¾—å›æ¥çœ‹å“¦ï½"
    )
    
    fun getFavoriteMessage(): String = favoriteMessages.random()
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ° å¹¸è¿æŠ½å¥–ï¼ˆä½æ¦‚ç‡å½©è›‹ï¼‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val luckyMessages = listOf(
        " ä»Šå¤©ä½ æ˜¯æ¬§çš‡ï¼",
        "ğŸ€ å››å¶è‰ä¿ä½‘ä½ ï¼",
        "ğŸ¯ æ­å–œè§¦å‘éšè—å½©è›‹ï¼",
        "âœ¨ ä½ è¢«é”¦é²¤é™„ä½“äº†ï¼",
        "ğŸŠ ç¬¬ 88888 ä½å¹¸è¿ç”¨æˆ·ï¼ï¼ˆå¹¶ä¸ï¼‰"
    )
    
    /**
     * ä½æ¦‚ç‡è§¦å‘å¹¸è¿å½©è›‹
     * @param probability è§¦å‘æ¦‚ç‡ (0.0 - 1.0)
     */
    fun tryLuckyMessage(probability: Float = 0.02f): String? {
        return if (Random.nextFloat() < probability) {
            luckyMessages.random()
        } else null
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ” æœç´¢å½©è›‹å…³é”®è¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val searchEasterEggs = mapOf(
        "bilipai" to "æ¬¢è¿ä½¿ç”¨ BiliPaiï¼æ„Ÿè°¢ä½ çš„æ”¯æŒ ",
        "å¼€å‘è€…" to "å¼€å‘è€…æ­£åœ¨åŠªåŠ›æ¬ç –ä¸­... ğŸ§±",
        "å½©è›‹" to "æ­å–œä½ æ‰¾åˆ°äº†å½©è›‹ï¼",
        "æ„Ÿè°¢" to "ä¸ç”¨è°¢ï¼Œåº”è¯¥çš„ï¼ğŸ˜Š",
        "666" to "è€é“åŒå‡» 666ï¼",
        "çˆ±ä½ " to "æˆ‘ä¹Ÿçˆ±ä½ ï¼ğŸ’•",
        "åŠ æ²¹" to "ä½ ä¹ŸåŠ æ²¹ï¼ğŸ’ª",
        "æ‘¸é±¼" to "è¢«ä½ æŠ“åˆ°äº†... ğŸŸ",
        "å¥½çœ‹" to "ä½ æ›´å¥½çœ‹ï¼âœ¨"
    )
    
    /**
     * æ£€æŸ¥æœç´¢å…³é”®è¯æ˜¯å¦è§¦å‘å½©è›‹
     */
    fun checkSearchEasterEgg(keyword: String): String? {
        val lowerKeyword = keyword.lowercase().trim()
        return searchEasterEggs.entries.find { 
            lowerKeyword.contains(it.key) 
        }?.value
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ˜´ ç©ºçŠ¶æ€è¶£å‘³æ–‡æ¡ˆ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private val emptyHistoryMessages = listOf(
        "è¿™é‡Œä»€ä¹ˆéƒ½æ²¡æœ‰... å¿«å»çœ‹è§†é¢‘å§ï¼",
        "å†å²è®°å½•ç©ºç©ºå¦‚ä¹Ÿï¼Œæ˜¯æ–°ç”¨æˆ·å—ï¼Ÿ",
        "è¿˜æ²¡çœ‹è¿‡è§†é¢‘ï¼Ÿæ¥æ¢ç´¢æ–°ä¸–ç•Œå§ï¼"
    )
    
    private val emptyFavoriteMessages = listOf(
        "æ”¶è—å¤¹ç©ºç©ºçš„ï¼Œç­‰ä½ æ¥å¡«æ»¡ï½",
        "å¥½è§†é¢‘å€¼å¾—æ”¶è—ï¼åŠ æ²¹ï¼",
        "å¿«å»å‘ç°å€¼å¾—æ”¶è—çš„å†…å®¹å§ï¼"
    )
    
    private val emptySearchMessages = listOf(
        "ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°... æ¢ä¸ªå…³é”®è¯è¯•è¯•ï¼Ÿ",
        "æœç´¢ç»“æœä¸ºç©ºï¼Œè¦ä¸è¯•è¯•å…¶ä»–çš„ï¼Ÿ",
        "æš‚æ— ç›¸å…³å†…å®¹ï¼Œä½†ç›¸ä¿¡ä½ èƒ½æ‰¾åˆ°çš„ï¼"
    )
    
    fun getEmptyHistoryMessage(): String = emptyHistoryMessages.random()
    fun getEmptyFavoriteMessage(): String = emptyFavoriteMessages.random()
    fun getEmptySearchMessage(): String = emptySearchMessages.random()
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ğŸ‘‹ é—®å€™è¯­ï¼ˆé¦–é¡µé¡¶éƒ¨ï¼‰
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    fun getGreeting(): String {
        val now = Calendar.getInstance()
        val hour = now.get(Calendar.HOUR_OF_DAY)
        
        return when (hour) {
            in 0..5 -> "å¤œæ·±äº†ï¼Œæ³¨æ„ä¼‘æ¯ "
            in 6..8 -> "æ—©ä¸Šå¥½ï¼â˜€ï¸"
            in 9..11 -> "ä¸Šåˆå¥½ï¼"
            in 12..13 -> "ä¸­åˆå¥½ï¼è¯¥åƒé¥­å•¦ ğŸš"
            in 14..17 -> "ä¸‹åˆå¥½ï¼"
            in 18..22 -> "æ™šä¸Šå¥½ï¼ğŸŒƒ"
            else -> "å¤œæ·±äº†ï¼Œæ³¨æ„ä¼‘æ¯ "
        }
    }
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    //  Konami Code å½©è›‹çŠ¶æ€
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    private var konamiSequence = mutableListOf<String>()
    private val konamiCode = listOf("up", "up", "down", "down", "left", "right", "left", "right")
    
    /**
     * è¾“å…¥ Konami æ‰‹åŠ¿
     * @return æ˜¯å¦è§¦å‘æˆåŠŸ
     */
    fun inputKonamiGesture(direction: String): Boolean {
        konamiSequence.add(direction)
        if (konamiSequence.size > konamiCode.size) {
            konamiSequence.removeAt(0)
        }
        return konamiSequence == konamiCode
    }
    
    fun resetKonamiSequence() {
        konamiSequence.clear()
    }
}
